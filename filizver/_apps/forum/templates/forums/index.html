{% extends 'forums/base.html' %}
{% load forum_tags %}
{% load i18n %}

{% block extra_meta %}
<script type="text/javascript" src="{{ STATIC_URL }}forums/js/jquery.cookie.js"></script>
<script type="text/javascript">

	function set_collapser(cat_id) {
		category_body_id = "category_body_" + cat_id;
		if($.cookie(category_body_id)){
			item_id = "#" + category_body_id;
			head_id = item_id.replace("body", "head");
			$(head_id).addClass("collapsed");
			$(item_id).hide()
		}
	}
	$(document).ready(function(){
		$("a.toggle").click(function(){
			header_id = $(this).parent().attr('id');
			body_id = header_id.replace("head", "body");
			item_id = '#' + body_id
			if ($(this).parent().attr('class')==''){
				$(this).parent().addClass("collapsed");
				$.cookie(body_id, 'collapsed');
			}else {
				$(this).parent().removeClass("collapsed");
				$.cookie(body_id, '');
			}
			$(item_id).slideToggle("slow");
		});
	{% for iter in cats %}
		set_collapser({{ iter.id }})
	{% endfor %}
	});
</script>
{% endblock %}

{% block content %}
{% for iter in cats %}
	<h4>{{ iter.cat }}</h4>
	<table class="table">
		<thead>
			<tr>
				<th class="tcl" scope="col">{% trans "Forum" %}</th>
				<th class="tc2" scope="col">{% trans "Topics" %}</th>
				<th class="tc3" scope="col">{% trans "Posts" %}</th>
				<th class="tcr" scope="col">{% trans "Last post" %}</th>
			</tr>
		</thead>
		<tbody>
		{% for forum in iter.forums %}
			{% include 'forums/forum_row.html' %}
		{% endfor %}
		</tbody>
	</table>
{% endfor %}
	<h4>{% trans "Board information" %}</h4>
	<div class="row">
		<dl class="span6">
			<dt>{% trans "Board statistics" %}</dt>
			<dd>{% trans "Total number of registered users:" %} <strong>{{ users }}</strong></dd>
			<dd>{% trans "Total number of topics:" %} <strong>{{ topics }}</strong></dd>
			<dd>{% trans "Total number of posts:" %} <strong>{{ posts }}</strong></dd>
		</dl>
		<dl class="span6">
			<dt>{% trans "User information" %}</dt>
			<dd>{% trans "Newest registered user:" %} {{ last_user }}</dd>
			<dd>{% trans "Registered users online:" %} <strong>{{ online_count }}</strong></dd>
			<dd>{% trans "Guests online:" %} <strong>{{ guest_count }}</strong></dd>
		</dl>
	</div>
    {% if online_count %}
    <dl id="onlinelist">
        <dt>{% trans "Online:" %}</dt>
        {% for online in users_online %}
            <dd>{{ online }}</dd>
        {% endfor %}
    </dl>
    {% endif %}
{% endblock %}
